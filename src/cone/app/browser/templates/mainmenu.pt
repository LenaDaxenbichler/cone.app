<tal:mainmenu xmlns:tal="http://xml.zope.org/namespaces/tal"
              xmlns:ajax="http://namesspaces.bluedynamics.eu/ajax"
              omit-tag="True">

  <ul id="mainmenu"
      class="nav navbar-nav contextsensitiv"
      ajax:bind="contextchanged"
      ajax:action="mainmenu:#mainmenu:replace"
      tal:define="layout model.layout">

    <tal:item repeat="item context.menuitems">

      <li tal:define="css item['selected'] and 'active' or '';
                      css ' '.join([css, 'node-%s' % item['id']]);"
          tal:attributes="class css">

        <a href="#"
           ajax:bind="click"
           ajax:target="${item['target']}"
           ajax:event="contextchanged:#layout"
           tal:attributes="title item['description'];"
          ><span class="${item['icon']|nothing}"></span>
          <span tal:content="item['title'] | string:'&nbsp;'">Title</span></a>

      </li>

    </tal:item>

    <tal:personaltools
      condition="layout.personaltools"
      replace="structure tile('personaltools')" />

    <tal:livesearch
      condition="layout.livesearch"
      replace="structure tile('livesearch')" />

  </ul>

</tal:mainmenu>
